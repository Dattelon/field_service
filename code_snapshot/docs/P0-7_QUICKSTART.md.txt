# P0-7: –°–≤—è–∑—å –∫–æ–º–∏—Å—Å–∏—è ‚Üî –∑–∞–∫–∞–∑ ‚Äî –ö–†–ê–¢–ö–ê–Ø –°–í–û–î–ö–ê

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–î–∞—Ç–∞**: 2025-10-08

---

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### –ò–∑–º–µ–Ω—ë–Ω 1 —Ñ–∞–π–ª

**`field_service/bots/master_bot/handlers/finance.py`**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∑–∞–∫–∞–∑—É –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `_render_commission_card`:

```python
buttons: list[list[InlineKeyboardButton]] = []

# P0-7: –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∑–∞–∫–∞–∑—É
if order and order.id:
    buttons.append([
        InlineKeyboardButton(
            text=f"üìã –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–∫–∞–∑ #{order.id}",
            callback_data=f"m:act:card:{order.id}"
        )
    ])

buttons.append([
    InlineKeyboardButton(text="üìÑ –†–µ–∫–≤–∏–∑–∏—Ç—ã", callback_data=f"m:fin:cm:pt:{commission.id}")
])
```

**–í—Å–µ–≥–æ**: 7 —Å—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ

---

## üéØ –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç

**–î–û**:
```
–§–∏–Ω–∞–Ω—Å—ã ‚Üí –ö–æ–º–∏—Å—Å–∏—è #456 (–∑–∞–∫–∞–∑ #123)
[—Ö–æ—á—É –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–∫–∞–∑]
‚ùå –ù–∞–∑–∞–¥ ‚Üí –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã ‚Üí –ü–æ–∏—Å–∫ #123
```

**–ü–û–°–õ–ï**:
```
–§–∏–Ω–∞–Ω—Å—ã ‚Üí –ö–æ–º–∏—Å—Å–∏—è #456 (–∑–∞–∫–∞–∑ #123)
[üìã –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–∫–∞–∑ #123] ‚Üê –û–¥–∏–Ω –∫–ª–∏–∫
‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞ #123
```

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç:

```
1. –ó–∞–π—Ç–∏ –≤ –º–∞—Å—Ç–µ—Ä-–±–æ—Ç
2. –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–∫–∞–∑ (WORKING ‚Üí PAYMENT)
3. "üí≥ –§–∏–Ω–∞–Ω—Å—ã" ‚Üí "–ö –æ–ø–ª–∞—Ç–µ"
4. –û—Ç–∫—Ä—ã—Ç—å –ª—é–±—É—é –∫–æ–º–∏—Å—Å–∏—é
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ö–Ω–æ–ø–∫–∞ "üìã –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–∫–∞–∑ #..." –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
6. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ü–µ—Ä–µ—Ö–æ–¥ –∫ –∫–∞—Ä—Ç–æ—á–∫–µ –∑–∞–∫–∞–∑–∞
```

---

## üìä –ì–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ö–Ω–æ–ø–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤–æ **–≤—Å–µ—Ö** —Ä–∞–∑–¥–µ–ª–∞—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤:
- üí≥ –ö –æ–ø–ª–∞—Ç–µ (WAIT_PAY, REPORTED)
- ‚úÖ –í—ã–ø–ª–∞—á–µ–Ω–æ (APPROVED)
- ‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ (OVERDUE)

---

## üîó –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

Callback `m:act:card:{order_id}` –∏–∑ `orders.py`:
- –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –∞–∫—Ç–∏–≤–Ω—ã–π ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É
- –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π ‚Üí "–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤"

---

## üìù –ß–µ–∫–ª–∏—Å—Ç

- [x] –ö–æ–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (1 —Ñ–∞–π–ª)
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ö–æ–º–º–∏—Ç –≤ git
- [ ] –î–µ–ø–ª–æ–π –Ω–∞ production

---

## üîó –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. —Ñ–∞–π–ª: `C:\ProjectF\docs\P0-7_COMMISSION_ORDER_LINK.md`

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏ P0

- **P0-6**: –í–æ–∑–≤—Ä–∞—Ç –ø–æ–∑–∏—Ü–∏–∏ –≤ —Å–ø–∏—Å–∫–µ –æ—á–µ—Ä–µ–¥–∏ (–ø—Ä–æ—Å—Ç–∞—è)
- **P0-2**: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ (—Å—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å)
- **P0-5**: –ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (—Å—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å)
