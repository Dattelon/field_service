# ๐งช P1-19: ะะฝััััะบัะธั ะฟะพ ัะตััะธัะพะฒะฐะฝะธั

## ะัััััะน ััะฐัั

### 1. ะะฐะฟััะบ ะฑะพัะพะฒ
```powershell
cd C:\ProjectF\field-service

# Master Bot
python -m field_service.bots.master_bot.main

# Admin Bot (ะฒ ะดััะณะพะผ ัะตัะผะธะฝะฐะปะต)
python -m field_service.bots.admin_bot.main
```

---

## โ ะขะตัั Master Bot

### ะกัะตะฝะฐัะธะน 1: ะะพะฟะธัะพะฒะฐะฝะธะต ัะตะปะตัะพะฝะฐ ะบะปะธะตะฝัะฐ
1. ะะฐะฟัััะธัั master bot
2. ะัะฟัะฐะฒะธัั `/start`
3. ะะบะปััะธัั ัะผะตะฝั (ะตัะปะธ ะฒัะบะปััะตะฝะฐ)
4. ะัะธะฝััั ะปัะฑะพะน ะทะฐะบะฐะท ะธะท "๐ ะะพะฒัะต ะทะฐะบะฐะทั"
5. ะัะบัััั "๐ฆ ะะบัะธะฒะฝัะน ะทะฐะบะฐะท"
6. **ะัะพะฒะตัะธัั:** ะะพะปะถะฝั ะฑััั ะบะฝะพะฟะบะธ:
   - ๐ ะะพะทะฒะพะฝะธัั ะบะปะธะตะฝัั (P0-4)
   - ๐ ะขะตะปะตัะพะฝ
   - ๐ ะะดัะตั

7. **ะะฐะถะฐัั "๐ ะขะตะปะตัะพะฝ"**
   - โ ะะพะปะถะตะฝ ะฟะพัะฒะธัััั alert ั ัะตะปะตัะพะฝะพะผ ะบะปะธะตะฝัะฐ
   - โ ะขะตะปะตัะพะฝ ะดะพะปะถะตะฝ ะฑััั ะฒ ัะพัะผะฐัะต: +7XXXXXXXXXX
   - โ ะขะตะบัั alert ะผะพะถะฝะพ ัะบะพะฟะธัะพะฒะฐัั

8. **ะะฐะถะฐัั "๐ ะะดัะตั"**
   - โ ะะพะปะถะตะฝ ะฟะพัะฒะธัััั alert ั ะฐะดัะตัะพะผ
   - โ ะคะพัะผะฐั: "ะะพัะพะด, ะะฐะนะพะฝ, ะฃะปะธัะฐ, ะะพะผ"
   - โ ะขะตะบัั alert ะผะพะถะฝะพ ัะบะพะฟะธัะพะฒะฐัั

### ะกัะตะฝะฐัะธะน 2: ะะฐะบะฐะท ะฑะตะท ัะตะปะตัะพะฝะฐ (edge case)
1. ะกะพะทะดะฐัั ะทะฐะบะฐะท ะฑะตะท ัะตะปะตัะพะฝะฐ ะบะปะธะตะฝัะฐ (ัะตัะตะท admin bot)
2. ะัะธะฝััั ััะพั ะทะฐะบะฐะท
3. ะัะบัััั "๐ฆ ะะบัะธะฒะฝัะน ะทะฐะบะฐะท"
4. **ะะฐะถะฐัั "๐ ะขะตะปะตัะพะฝ"**
   - โ ะะพะปะถะตะฝ ะฟะพัะฒะธัััั alert: "โ ะขะตะปะตัะพะฝ ะฝะต ัะบะฐะทะฐะฝ"

---

## โ ะขะตัั Admin Bot

### ะกัะตะฝะฐัะธะน 1: ะะพะฟะธัะพะฒะฐะฝะธะต ะดะฐะฝะฝัั ะทะฐะบะฐะทะฐ
1. ะะฐะฟัััะธัั admin bot
2. ะัะฟัะฐะฒะธัั `/start`
3. ะัะฑัะฐัั "๐ ะัะตัะตะดั ะทะฐัะฒะพะบ"
4. ะัะฑัะฐัั ะปัะฑะพะน ะทะฐะบะฐะท ั ะฝะฐะทะฝะฐัะตะฝะฝัะผ ะผะฐััะตัะพะผ
5. **ะัะพะฒะตัะธัั:** ะะพะปะถะฝั ะฑััั ะบะฝะพะฟะบะธ:
   - ๐ ะขะตะปะตัะพะฝ ะบะปะธะตะฝัะฐ
   - ๐ ะขะตะปะตัะพะฝ ะผะฐััะตัะฐ
   - ๐ ะะดัะตั

6. **ะะฐะถะฐัั "๐ ะขะตะปะตัะพะฝ ะบะปะธะตะฝัะฐ"**
   - โ ะะพะปะถะตะฝ ะฟะพัะฒะธัััั alert ั ัะตะปะตัะพะฝะพะผ ะบะปะธะตะฝัะฐ
   - โ ะคะพัะผะฐั: +7XXXXXXXXXX

7. **ะะฐะถะฐัั "๐ ะขะตะปะตัะพะฝ ะผะฐััะตัะฐ"**
   - โ ะะพะปะถะตะฝ ะฟะพัะฒะธัััั alert ั ัะตะปะตัะพะฝะพะผ ะผะฐััะตัะฐ
   - โ ะคะพัะผะฐั: +7XXXXXXXXXX

8. **ะะฐะถะฐัั "๐ ะะดัะตั"**
   - โ ะะพะปะถะตะฝ ะฟะพัะฒะธัััั alert ั ะฟะพะปะฝัะผ ะฐะดัะตัะพะผ
   - โ ะคะพัะผะฐั: "ะะพัะพะด, ะะฐะนะพะฝ, ะฃะปะธัะฐ, ะะพะผ"

### ะกัะตะฝะฐัะธะน 2: ะะฐะบะฐะท ะฑะตะท ะผะฐััะตัะฐ (edge case)
1. ะัะฑัะฐัั ะทะฐะบะฐะท ะฒ ััะฐัััะต SEARCHING (ะฑะตะท ะผะฐััะตัะฐ)
2. **ะะฐะถะฐัั "๐ ะขะตะปะตัะพะฝ ะผะฐััะตัะฐ"**
   - โ ะะพะปะถะตะฝ ะฟะพัะฒะธัััั alert: "โ ะะฐััะตั ะฝะต ะฝะฐะทะฝะฐัะตะฝ ะธะปะธ ัะตะปะตัะพะฝ ะฝะต ัะบะฐะทะฐะฝ"
3. **ะะฝะพะฟะบะธ "๐ ะขะตะปะตัะพะฝ ะบะปะธะตะฝัะฐ" ะธ "๐ ะะดัะตั" ะดะพะปะถะฝั ัะฐะฑะพัะฐัั**

### ะกัะตะฝะฐัะธะน 3: ะัะพะฒะตัะบะฐ ะฟัะฐะฒ ะดะพัััะฟะฐ
1. ะะฐะนัะธ ะฟะพะด GLOBAL_ADMIN โ ะฒัะต ะบะฝะพะฟะบะธ ัะฐะฑะพัะฐัั
2. ะะฐะนัะธ ะฟะพะด CITY_ADMIN โ ะฒัะต ะบะฝะพะฟะบะธ ัะฐะฑะพัะฐัั
3. ะะฐะนัะธ ะฟะพะด LOGIST โ ะฒัะต ะบะฝะพะฟะบะธ ัะฐะฑะพัะฐัั

---

## ๐ ะงัะพ ะฟัะพะฒะตัััั ะฒะธะทัะฐะปัะฝะพ

### Master Bot - ะะบัะธะฒะฝัะน ะทะฐะบะฐะท
```
๐ฆ ะะบัะธะฒะฝัะน ะทะฐะบะฐะท #123
๐ ะะดัะตั: ะะพัะบะฒะฐ, ะฆะตะฝััะฐะปัะฝัะน, ัะป. ะะตะฝะธะฝะฐ, 10
๐ ะกะปะพั: 10:00-12:00
๐ ะขะตะบััะธะน ััะฐััั: ะะฐะทะฝะฐัะตะฝะพ ะผะฐััะตัั
๐ ะะฐัะตะณะพัะธั: ะญะปะตะบััะธะบะฐ
๐ค ะะปะธะตะฝั: ะะฒะฐะฝ ะะฒะฐะฝะพะฒ
๐ ะขะตะปะตัะพะฝ: +79991234567

[๐ ะ ะฟััะธ]
[๐ ะะพะทะฒะพะฝะธัั ะบะปะธะตะฝัั]
[๐ ะขะตะปะตัะพะฝ] [๐ ะะดัะตั]    โ P1-19
[โฌ๏ธ ะะฐะทะฐะด] [๐ ะะตะฝั]
```

### Admin Bot - ะะฐััะพัะบะฐ ะทะฐะบะฐะทะฐ
```
๐งพ ะะฐะบะฐะท #123
๐ ะะพัะบะฒะฐ, ะฆะตะฝััะฐะปัะฝัะน, ัะป. ะะตะฝะธะฝะฐ, 10
๐ง ะะฐัะตะณะพัะธั: ะญะปะตะบััะธะบะฐ
๐ฆ ะขะธะฟ: NORMAL
โฐ ะกะปะพั: 10:00-12:00
๐ ะกัะฐััั: ASSIGNED
๐ ะกะพะทะดะฐะฝ: 2024-10-09 08:30
๐ค ะะปะธะตะฝั: ะะฒะฐะฝ ะะฒะฐะฝะพะฒ (+79991234567)
๐ค ะะฐััะตั: ะััั ะะตััะพะฒ (+79997654321)

[๐ก ะะฐัะฐะฝัะธั]
[๐ฅ ะะฐะทะฝะฐัะธัั]
[๐ ะขะตะปะตัะพะฝ ะบะปะธะตะฝัะฐ] [๐ ะขะตะปะตัะพะฝ ะผะฐััะตัะฐ] [๐ ะะดัะตั]    โ P1-19
[โฌ๏ธ ะะฐะทะฐะด] [โ๏ธ ะัะผะตะฝะธัั]
[๐ ะ ัะฟะธัะบั]
```

---

## ๐ ะะทะฒะตััะฝัะต ะฟัะพะฑะปะตะผั

### ะะณัะฐะฝะธัะตะฝะธะต Telegram Alert
- Alert ัะตะบัั ะพะณัะฐะฝะธัะตะฝ ~200 ัะธะผะฒะพะปะฐะผะธ
- ะะปั ะพัะตะฝั ะดะปะธะฝะฝัั ะฐะดัะตัะพะฒ ะผะพะถะตั ะพะฑัะตะทะฐัััั
- **ะะตัะตะฝะธะต:** ะขะตะบััะฐั ัะตะฐะปะธะทะฐัะธั ะฟะพะบััะฒะฐะตั 99% ัะปััะฐะตะฒ

### Windows encoding ะฒ ะปะพะณะฐั
- ะัะปะธ ะฒ print/log ะตััั ัะผะพะดะทะธ โ UnicodeEncodeError
- **ะะตัะตะฝะธะต:** ะัะฟะพะปัะทัะตะผ ัะพะปัะบะพ ASCII ะฒ ะปะพะณะฐั

---

## ๐ ะะตััะธะบะธ ััะฟะตัะฐ

ะะพัะปะต ัะตััะธัะพะฒะฐะฝะธั ะฟัะพะฒะตัะธัั:
- [ ] ะัะต edge cases ะพะฑัะฐะฑะพัะฐะฝั ะบะพััะตะบัะฝะพ
- [ ] Alert'ั ะฟะพัะฒะปััััั ะผะณะฝะพะฒะตะฝะฝะพ (<500ms)
- [ ] ะะฐะฝะฝัะต ะบะพะฟะธัััััั ะบะพััะตะบัะฝะพ
- [ ] ะะตั ะพัะธะฑะพะบ ะฒ ะปะพะณะฐั ะฟัะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธะธ
- [ ] ะะฝะพะฟะบะธ ะฝะต ะฟะตัะตะบััะฒะฐัั ะดััะณะธะต ัะปะตะผะตะฝัั UI
- [ ] ะะฐะฑะพัะฐะตั ะฝะฐ ะผะพะฑะธะปัะฝัั ััััะพะนััะฒะฐั

---

## ๐ Rollback ะฟะปะฐะฝ

ะัะปะธ ััะพ-ัะพ ะฟะพะนะดัั ะฝะต ัะฐะบ:

```bash
# 1. ะัะบะฐัะธัั ะธะทะผะตะฝะตะฝะธั ะฒ master_bot
git checkout HEAD -- field_service/bots/master_bot/handlers/orders.py

# 2. ะัะบะฐัะธัั ะธะทะผะตะฝะตะฝะธั ะฒ admin_bot
git checkout HEAD -- field_service/bots/admin_bot/ui/keyboards/orders.py
git checkout HEAD -- field_service/bots/admin_bot/handlers/orders/__init__.py
rm field_service/bots/admin_bot/handlers/orders/copy_data.py

# 3. ะฃะดะฐะปะธัั copy_utils
rm field_service/bots/common/copy_utils.py

# 4. ะะตัะตะทะฐะฟัััะธัั ะฑะพัะพะฒ
```

---

**ะะพัะพะฒะพ ะบ ัะตััะธัะพะฒะฐะฝะธั!** ๐

ะัะปะธ ะฝะฐััะป ะฑะฐะณะธ - ะดะพะบัะผะตะฝัะธััะน ะฒ ะพัะดะตะปัะฝะพะผ ัะฐะนะปะต:
`C:\ProjectF\docs\P1-19_BUGS.md`
