# üéØ –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï –°–¢–†–ê–¢–ï–ì–ò–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø TELEGRAM –ë–û–¢–û–í

## ‚ùå –ß—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫?
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è Telegram API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤–µ–ª–æ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π.

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –ü–û–î–•–û–î–´

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–æ–º–µ—Ä (–õ–£–ß–®–ò–ô –≤–∞—Ä–∏–∞–Ω—Ç)
**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –æ—Ç –ª–∏—á–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å:**
- –ö—É–ø–∏—Ç—å –¥–µ—à—ë–≤—É—é SIM-–∫–∞—Ä—Ç—É –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (~100‚ÇΩ)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä (https://sms-activate.ru)
- –ü–æ–ø—Ä–æ—Å–∏—Ç—å —É –∫–æ–ª–ª–µ–≥ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –Ω–æ–º–µ—Ä

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~50-200‚ÇΩ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ

### 2. Mock-–ø–æ–¥—Ö–æ–¥ (E2E —Ç–µ—Å—Ç—ã –ë–ï–ó —Ä–µ–∞–ª—å–Ω–æ–≥–æ Telegram)
**–ü–ª—é—Å—ã:**
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç Telegram API
- –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
class MockTelegramBot:
    def __init__(self):
        self.messages = []
        self.buttons = []
    
    async def send_message(self, chat_id, text, reply_markup=None):
        self.messages.append({"chat_id": chat_id, "text": text})
        if reply_markup:
            self.buttons.append(reply_markup)
    
    async def get_last_message(self):
        return self.messages[-1] if self.messages else None
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Web API (–±–µ–∑ Telethon)
**–ü–ª—é—Å—ã:**
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Bot API –Ω–∞–ø—Ä—è–º—É—é

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
import requests

class BotAPITester:
    def __init__(self, bot_token):
        self.token = bot_token
        self.base_url = f"https://api.telegram.org/bot{bot_token}"
    
    def send_command(self, chat_id, text):
        return requests.post(f"{self.base_url}/sendMessage", 
                           json={"chat_id": chat_id, "text": text})
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π chat_id (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ webhook)

### 4. Telegram Bot API Webhook —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –±–æ—Ç—É —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–π Telegram (–≤—Ä—É—á–Ω—É—é –æ–¥–∏–Ω —Ä–∞–∑)
2. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç webhook
3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑ –ë–î –∏–ª–∏ –ª–æ–≥–∏

**–ü–ª—é—Å—ã:**
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç Telegram API –∫–ª–∏–µ–Ω—Ç–∞
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø –î–õ–Ø –ü–†–û–ï–ö–¢–ê

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥:

1. **–î–ª—è Unit-—Ç–µ—Å—Ç–æ–≤:** Mock-–æ–±—ä–µ–∫—Ç—ã (–±—ã—Å—Ç—Ä–æ, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ)
2. **–î–ª—è Integration-—Ç–µ—Å—Ç–æ–≤:** –¢–µ—Å—Ç—ã —á–µ—Ä–µ–∑ –ë–î (–ø—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏–∫—É –±–µ–∑ UI)
3. **–î–ª—è E2E-—Ç–µ—Å—Ç–æ–≤:** –û—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–æ–º–µ—Ä –ò–õ–ò —Ä—É—á–Ω–æ–µ smoke-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìã –ß—Ç–æ –¥–µ–ª–∞—Ç—å –°–ï–ô–ß–ê–°?

### –í–∞—Ä–∏–∞–Ω—Ç A: –ö—É–ø–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–æ–º–µ—Ä
```bash
# 1. –ü–æ–ª—É—á–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –Ω–∞ sms-activate.ru
# 2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é —Å —ç—Ç–∏–º –Ω–æ–º–µ—Ä–æ–º
# 3. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ Mock-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–†–ï–ö–û–ú–ï–ù–î–£–Æ)
```bash
# 1. –°–æ–∑–¥–∞—Ç—å mock-–≤–µ—Ä—Å–∏—é Telegram –∫–ª–∏–µ–Ω—Ç–∞
# 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É —á–µ—Ä–µ–∑ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã handlers
# 3. E2E —Ç–µ—Å—Ç—ã –¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ webhook
```

### –í–∞—Ä–∏–∞–Ω—Ç C: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ –ë–î
```python
# –ü—Ä–∏–º–µ—Ä: —Ç–µ—Å—Ç–∏—Ä—É–µ–º –≤–µ—Å—å flow –±–µ–∑ Telegram UI
async def test_order_lifecycle():
    # –°–æ–∑–¥–∞—ë–º –º–∞—Å—Ç–µ—Ä–∞ –≤ –ë–î
    master = await create_master_in_db(...)
    
    # –°–∏–º—É–ª–∏—Ä—É–µ–º –∑–∞–∫–∞–∑
    order = await create_order_in_db(...)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    await tick_once(...)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –æ—Ñ—Ñ–µ—Ä —Å–æ–∑–¥–∞–Ω
    assert await get_offers_count() == 1
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ –±—É–¥—É—â–µ–º

1. **–ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä –¥–ª—è API —Ç–µ—Å—Ç–æ–≤**
2. **–í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã**
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ .env –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è credentials**
4. **–î–æ–±–∞–≤—å—Ç–µ –≤ .gitignore:**
   ```
   test_session.session
   *.session-journal
   test_credentials.json
   ```

## üí° –ú–æ–π –≤—ã–≤–æ–¥:

**–î–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –ª—É—á—à–µ –≤—Å–µ–≥–æ:**
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ –ë–î (—É–∂–µ –µ—Å—Ç—å –≤ `tests/e2e/`)
- Smoke-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI –≤—Ä—É—á–Ω—É—é
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ UI ‚Üí –∫—É–ø–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–æ–º–µ—Ä

**–ù–ï —Å—Ç–æ–∏—Ç:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è UI —Ç–µ—Å—Ç–æ–≤ –µ—Å–ª–∏ –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –Ω–∞–ø—Ä—è–º—É—é
