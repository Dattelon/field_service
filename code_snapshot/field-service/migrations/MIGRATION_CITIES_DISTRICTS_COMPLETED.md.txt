# –ú–∏–≥—Ä–∞—Ü–∏—è –≥–æ—Ä–æ–¥–æ–≤ –∏ —Ä–∞–π–æ–Ω–æ–≤ - –ó–ê–í–ï–†–®–ï–ù–û ‚úÖ

**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2025-10-07  
**–°—Ç–∞—Ç—É—Å:** –£—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏

### –ì–æ—Ä–æ–¥–∞
- **–í—Å–µ–≥–æ –≥–æ—Ä–æ–¥–æ–≤:** 79 (78 –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ + Test City)
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ã—Ö:** 78 –≥–æ—Ä–æ–¥–æ–≤
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ `cities.py` –¥–æ–±–∞–≤–ª–µ–Ω—ã
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–ø–µ—á–∞—Ç–∫–∞ "–¢–∞–≥–∞–¥–æ–≥" ‚Üí "–¢–∞–≥–∞–Ω—Ä–æ–≥", —É–¥–∞–ª–µ–Ω –¥—É–±–ª–∏–∫–∞—Ç "–†–æ—Å—Ç–æ–≤ –Ω–∞ –î–æ–Ω—É"

### –†–∞–π–æ–Ω—ã
- **–í—Å–µ–≥–æ —Ä–∞–π–æ–Ω–æ–≤:** 149
- **–ì–æ—Ä–æ–¥–æ–≤ —Å —Ä–∞–π–æ–Ω–∞–º–∏:** 20 –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ã—Ö:** 148 —Ä–∞–π–æ–Ω–æ–≤

## üèôÔ∏è –ì–æ—Ä–æ–¥–∞ —Å —Ä–∞–π–æ–Ω–∞–º–∏

| –ì–æ—Ä–æ–¥ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–π–æ–Ω–æ–≤ |
|-------|-------------------|
| –ú–æ—Å–∫–≤–∞ | 12 –æ–∫—Ä—É–≥–æ–≤ |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | 18 —Ä–∞–π–æ–Ω–æ–≤ |
| –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ | 10 —Ä–∞–π–æ–Ω–æ–≤ |
| –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ | 7 —Ä–∞–π–æ–Ω–æ–≤ |
| –ö–∞–∑–∞–Ω—å | 7 —Ä–∞–π–æ–Ω–æ–≤ |
| –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ | 8 —Ä–∞–π–æ–Ω–æ–≤ |
| –ß–µ–ª—è–±–∏–Ω—Å–∫ | 7 —Ä–∞–π–æ–Ω–æ–≤ |
| –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ | 7 —Ä–∞–π–æ–Ω–æ–≤ |
| –°–∞–º–∞—Ä–∞ | 9 —Ä–∞–π–æ–Ω–æ–≤ |
| –£—Ñ–∞ | 7 —Ä–∞–π–æ–Ω–æ–≤ |
| –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É | 8 —Ä–∞–π–æ–Ω–æ–≤ |
| –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä | 4 —Ä–∞–π–æ–Ω–∞ |
| –û–º—Å–∫ | 5 –æ–∫—Ä—É–≥–æ–≤ |
| –í–æ—Ä–æ–Ω–µ–∂ | 6 —Ä–∞–π–æ–Ω–æ–≤ |
| –ü–µ—Ä–º—å | 7 —Ä–∞–π–æ–Ω–æ–≤ |
| –í–æ–ª–≥–æ–≥—Ä–∞–¥ | 8 —Ä–∞–π–æ–Ω–æ–≤ |
| –°–∞—Ä–∞—Ç–æ–≤ | 6 —Ä–∞–π–æ–Ω–æ–≤ |
| –¢—é–º–µ–Ω—å | 4 —Ä–∞–π–æ–Ω–∞ |
| –¢–æ–ª—å—è—Ç—Ç–∏ | 3 —Ä–∞–π–æ–Ω–∞ |
| –ò–∂–µ–≤—Å–∫ | 5 —Ä–∞–π–æ–Ω–æ–≤ |

## üìù –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–∏

1. **add_all_cities.sql** - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö 78 –≥–æ—Ä–æ–¥–æ–≤
2. **add_districts_fixed.sql** - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–π–æ–Ω–æ–≤ –¥–ª—è 20 –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

## üöÄ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∞–¥–º–∏–Ω-–±–æ—Ç–µ

### –î–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚ùå –¢–æ–ª—å–∫–æ 21 –≥–æ—Ä–æ–¥ –∏–∑ 78
- ‚ùå 1 —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–∞–π–æ–Ω
- ‚ùå –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≥–æ—Ä–æ–¥–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –í—Å–µ 79 –≥–æ—Ä–æ–¥–æ–≤ (78 + Test City)
- ‚úÖ 149 —Ä–∞–π–æ–Ω–æ–≤ (148 + —Ç–µ—Å—Ç–æ–≤—ã–π)
- ‚úÖ 20 –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ —Å –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º —Ä–∞–π–æ–Ω–æ–≤
- ‚úÖ –ì–æ—Ä–æ–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- ‚úÖ –î–ª—è –≥–æ—Ä–æ–¥–æ–≤ –±–µ–∑ —Ä–∞–π–æ–Ω–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "üö´ –ë–µ–∑ —Ä–∞–π–æ–Ω–∞"

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Ä–æ–¥–æ–≤
```powershell
docker exec -i field-service-postgres-1 psql -U fs_user -d field_service -c "SELECT COUNT(*) FROM cities WHERE is_active = true;"
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 79

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–π–æ–Ω–æ–≤
```powershell
docker exec -i field-service-postgres-1 psql -U fs_user -d field_service -c "SELECT COUNT(*) FROM districts;"
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 149

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ä–æ–¥–∞ —Å —Ä–∞–π–æ–Ω–∞–º–∏
```powershell
docker exec -i field-service-postgres-1 psql -U fs_user -d field_service -c "SELECT c.name, COUNT(d.id) as districts FROM cities c LEFT JOIN districts d ON d.city_id = c.id WHERE c.name IN ('–ú–æ—Å–∫–≤–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫') GROUP BY c.name ORDER BY c.name;"
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ú–æ—Å–∫–≤–∞: 12 –æ–∫—Ä—É–≥–æ–≤
- –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥: 18 —Ä–∞–π–æ–Ω–æ–≤
- –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫: 10 —Ä–∞–π–æ–Ω–æ–≤

## üì± –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∞–¥–º–∏–Ω-–±–æ—Ç–µ

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏** ‚Üí "üåÜ –í—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥"
2. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∏–∑ 79 –≥–æ—Ä–æ–¥–æ–≤ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
3. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –≥–æ—Ä–æ–¥–∞:
   - –ï—Å–ª–∏ —É –≥–æ—Ä–æ–¥–∞ –µ—Å—Ç—å —Ä–∞–π–æ–Ω—ã ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Ä–∞–π–æ–Ω–æ–≤ + "üö´ –ë–µ–∑ —Ä–∞–π–æ–Ω–∞"
   - –ï—Å–ª–∏ —É –≥–æ—Ä–æ–¥–∞ –Ω–µ—Ç —Ä–∞–π–æ–Ω–æ–≤ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è "–ë–µ–∑ —Ä–∞–π–æ–Ω–∞"

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã cities
- `id` - PRIMARY KEY
- `name` - UNIQUE, NOT NULL
- `is_active` - BOOLEAN
- `timezone` - VARCHAR(64)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã districts
- `id` - PRIMARY KEY
- `city_id` - FOREIGN KEY ‚Üí cities(id)
- `name` - NOT NULL
- `created_at` - TIMESTAMP
- UNIQUE CONSTRAINT –Ω–∞ (city_id, name)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–æ–≤
INSERT INTO cities (name, is_active, timezone) VALUES (...) 
ON CONFLICT (name) DO UPDATE SET is_active = EXCLUDED.is_active;

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–π–æ–Ω–æ–≤
INSERT INTO districts (city_id, name) 
SELECT c.id, d.name FROM cities c, (VALUES (...)) AS d(name)
WHERE c.name = '–ì–æ—Ä–æ–¥'
ON CONFLICT (city_id, name) DO NOTHING;

-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—á–∞—Ç–∫–∏
UPDATE cities SET name = '–¢–∞–≥–∞–Ω—Ä–æ–≥' WHERE name = '–¢–∞–≥–∞–¥–æ–≥';

-- –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–∞
DELETE FROM cities WHERE name = '–†–æ—Å—Ç–æ–≤ –Ω–∞ –î–æ–Ω—É';
```

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–∏–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ê–¥–º–∏–Ω-–±–æ—Ç —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:
- ‚úÖ –í—Å–µ 79 –≥–æ—Ä–æ–¥–æ–≤ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- ‚úÖ –†–∞–π–æ–Ω—ã –¥–ª—è 20 –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- ‚úÖ –û–ø—Ü–∏—é "üö´ –ë–µ–∑ —Ä–∞–π–æ–Ω–∞" –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤

**–ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è** - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ë–î.

---
*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ 2025-10-07*
