# üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –£–ø—Ä–æ—â–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–∞–π–æ–Ω–æ–≤

**–î–∞—Ç–∞:** 2025-10-04  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é  
**–°–∫—Ä–∏–ø—Ç:** `scripts/migrate_districts_simplification.sql`

---

## üéØ –¶–µ–ª—å

–ü—Ä–∏–≤–µ—Å—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–∞–π–æ–Ω–æ–≤ –≤–æ –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–∞—Ö –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –µ–¥–∏–Ω–∏—Ü–∞–º:
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –æ–∫—Ä—É–≥–∞** (–ú–æ—Å–∫–≤–∞, –ò—Ä–∫—É—Ç—Å–∫, –û–º—Å–∫, –¢—é–º–µ–Ω—å, –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä)
- **–†–∞–π–æ–Ω—ã** (–≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ò—Ä–∫—É—Ç—Å–∫–µ —Å–µ–π—á–∞—Å 654 —Ä–∞–π–æ–Ω–∞ (–≤–∫–ª—é—á–∞—è –∫–≤–∞—Ä—Ç–∞–ª—ã, –°–ù–¢, –ñ–ö), –∞ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ 4 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–∞.

---

## üìä –ò–∑–º–µ–Ω–µ–Ω–∏—è

### –î–æ –º–∏–≥—Ä–∞—Ü–∏–∏:
- **–ò—Ä–∫—É—Ç—Å–∫:** 654 —Ä–∞–π–æ–Ω–∞ ‚ùå
- **–ú–æ—Å–∫–≤–∞:** 139 —Ä–∞–π–æ–Ω–æ–≤ (—Å–º–µ—à–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞) ‚ùå
- **–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥:** 111 —Ä–∞–π–æ–Ω–æ–≤ (—Å–º–µ—à–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞) ‚ùå
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞:** "–ì–æ—Ä–æ–¥ —Ü–µ–ª–∏–∫–æ–º" (1 —Ä–∞–π–æ–Ω) ‚ö†Ô∏è
- **–î—É–±–ª–∏–∫–∞—Ç:** "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥" (id=5) ‚ùå

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- **–ò—Ä–∫—É—Ç—Å–∫:** 4 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–∞ ‚úÖ
- **–ú–æ—Å–∫–≤–∞:** 12 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–æ–≤ ‚úÖ
- **–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥:** 18 —Ä–∞–π–æ–Ω–æ–≤ ‚úÖ
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞:** –û—Ç 3 –¥–æ 10 —Ä–∞–π–æ–Ω–æ–≤ ‚úÖ
- **–î—É–±–ª–∏–∫–∞—Ç:** –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω ‚úÖ

---

## üèôÔ∏è –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ –≥–æ—Ä–æ–¥–∞–º

### –ú–æ—Å–∫–≤–∞ (12 –æ–∫—Ä—É–≥–æ–≤):
1. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ê–û
2. –°–µ–≤–µ—Ä–Ω—ã–π –ê–û
3. –°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –ê–û
4. –í–æ—Å—Ç–æ—á–Ω—ã–π –ê–û
5. –Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –ê–û
6. –Æ–∂–Ω—ã–π –ê–û
7. –Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –ê–û
8. –ó–∞–ø–∞–¥–Ω—ã–π –ê–û
9. –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –ê–û
10. –ó–µ–ª–µ–Ω–æ–≥—Ä–∞–¥—Å–∫–∏–π –ê–û
11. –ù–æ–≤–æ–º–æ—Å–∫–æ–≤—Å–∫–∏–π –ê–û
12. –¢—Ä–æ–∏—Ü–∫–∏–π –ê–û

### –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ (18 —Ä–∞–π–æ–Ω–æ–≤):
1. –ê–¥–º–∏—Ä–∞–ª—Ç–µ–π—Å–∫–∏–π
2. –í–∞—Å–∏–ª–µ–æ—Å—Ç—Ä–æ–≤—Å–∫–∏–π
3. –í—ã–±–æ—Ä–≥—Å–∫–∏–π
4. –ö–∞–ª–∏–Ω–∏–Ω—Å–∫–∏–π
5. –ö–∏—Ä–æ–≤—Å–∫–∏–π
6. –ö–æ–ª–ø–∏–Ω—Å–∫–∏–π
7. –ö—Ä–∞—Å–Ω–æ–≥–≤–∞—Ä–¥–µ–π—Å–∫–∏–π
8. –ö—Ä–∞—Å–Ω–æ—Å–µ–ª—å—Å–∫–∏–π
9. –ö—Ä–æ–Ω—à—Ç–∞–¥—Ç—Å–∫–∏–π
10. –ö—É—Ä–æ—Ä—Ç–Ω—ã–π
11. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π
12. –ù–µ–≤—Å–∫–∏–π
13. –ü–µ—Ç—Ä–æ–≥—Ä–∞–¥—Å–∫–∏–π
14. –ü–µ—Ç—Ä–æ–¥–≤–æ—Ä—Ü–æ–≤—ã–π
15. –ü—Ä–∏–º–æ—Ä—Å–∫–∏–π
16. –ü—É—à–∫–∏–Ω—Å–∫–∏–π
17. –§—Ä—É–Ω–∑–µ–Ω—Å–∫–∏–π
18. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π

### –ò—Ä–∫—É—Ç—Å–∫ (4 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–∞):
1. –õ–µ–Ω–∏–Ω—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥
2. –û–∫—Ç—è–±—Ä—å—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥
3. –ü—Ä–∞–≤–æ–±–µ—Ä–µ–∂–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥
4. –°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥

### –ö—Ä—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ (7-10 —Ä–∞–π–æ–Ω–æ–≤):
- **–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ (10):** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π, –ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π, –ó–∞–µ–ª—å—Ü–æ–≤—Å–∫–∏–π, –õ–µ–Ω–∏–Ω—Å–∫–∏–π, –î–∑–µ—Ä–∂–∏–Ω—Å–∫–∏–π, –ö–∞–ª–∏–Ω–∏–Ω—Å–∫–∏–π, –ö–∏—Ä–æ–≤—Å–∫–∏–π, –û–∫—Ç—è–±—Ä—å—Å–∫–∏–π, –ü–µ—Ä–≤–æ–º–∞–π—Å–∫–∏–π, –°–æ–≤–µ—Ç—Å–∫–∏–π
- **–°–∞–º–∞—Ä–∞ (9):** –ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π, –ö–∏—Ä–æ–≤—Å–∫–∏–π, –ö—Ä–∞—Å–Ω–æ–≥–ª–∏–Ω—Å–∫–∏–π, –ö—É–π–±—ã—à–µ–≤—Å–∫–∏–π, –õ–µ–Ω–∏–Ω—Å–∫–∏–π, –û–∫—Ç—è–±—Ä—å—Å–∫–∏–π, –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π, –°–∞–º–∞—Ä—Å–∫–∏–π, –°–æ–≤–µ—Ç—Å–∫–∏–π
- **–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ (8):** –ê–≤—Ç–æ–∑–∞–≤–æ–¥—Å–∫–∏–π, –ö–∞–Ω–∞–≤–∏–Ω—Å–∫–∏–π, –õ–µ–Ω–∏–Ω—Å–∫–∏–π, –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, –ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∏–π, –ü—Ä–∏–æ–∫—Å–∫–∏–π, –°–æ–≤–µ—Ç—Å–∫–∏–π, –°–æ—Ä–º–æ–≤—Å–∫–∏–π
- **–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É (8):** –í–æ—Ä–æ—à–∏–ª–æ–≤—Å–∫–∏–π, –ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π, –ö–∏—Ä–æ–≤—Å–∫–∏–π, –õ–µ–Ω–∏–Ω—Å–∫–∏–π, –û–∫—Ç—è–±—Ä—å—Å–∫–∏–π, –ü–µ—Ä–≤–æ–º–∞–π—Å–∫–∏–π, –ü—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∏–π, –°–æ–≤–µ—Ç—Å–∫–∏–π
- **–í–æ–ª–≥–æ–≥—Ä–∞–¥ (8):** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π, –î–∑–µ—Ä–∂–∏–Ω—Å–∫–∏–π, –í–æ—Ä–æ—à–∏–ª–æ–≤—Å–∫–∏–π, –ö–∏—Ä–æ–≤—Å–∫–∏–π, –ö—Ä–∞—Å–Ω–æ–æ–∫—Ç—è–±—Ä—å—Å–∫–∏–π, –ö—Ä–∞—Å–Ω–æ–∞—Ä–º–µ–π—Å–∫–∏–π, –°–æ–≤–µ—Ç—Å–∫–∏–π, –¢—Ä–∞–∫—Ç–æ—Ä–æ–∑–∞–≤–æ–¥—Å–∫–∏–π
- **–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ (7), –ö–∞–∑–∞–Ω—å (7), –ß–µ–ª—è–±–∏–Ω—Å–∫ (7), –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫ (7), –£—Ñ–∞ (7), –ü–µ—Ä–º—å (7)**

### –°—Ä–µ–¥–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (4-6 —Ä–∞–π–æ–Ω–æ–≤):
- **–í–æ—Ä–æ–Ω–µ–∂ (6), –°–∞—Ä–∞—Ç–æ–≤ (6), –Ø—Ä–æ—Å–ª–∞–≤–ª—å (6), –ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫ (6)**
- **–ò–∂–µ–≤—Å–∫ (5), –ë–∞—Ä–Ω–∞—É–ª (5), –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫ (5), –ö–µ–º–µ—Ä–æ–≤–æ (5), –û–º—Å–∫ (5)**
- **–¢—é–º–µ–Ω—å (4), –ê—Å—Ç—Ä–∞—Ö–∞–Ω—å (4), –ü–µ–Ω–∑–∞ (4), –ö–∏—Ä–æ–≤ (4), –õ–∏–ø–µ—Ü–∫ (4), –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥ (4), –¢–æ–º—Å–∫ (4), –û—Ä–µ–Ω–±—É—Ä–≥ (4), –†—è–∑–∞–Ω—å (4), –•–∞–±–∞—Ä–æ–≤—Å–∫ (4), –£–ª—å—è–Ω–æ–≤—Å–∫ (4), –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä (4)**

### –ú–∞–ª—ã–µ –≥–æ—Ä–æ–¥–∞ (3 —Ä–∞–π–æ–Ω–∞):
- **–¢–æ–ª—å—è—Ç—Ç–∏, –ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã, –ß–µ–±–æ–∫—Å–∞—Ä—ã, –ú–∞—Ö–∞—á–∫–∞–ª–∞**

---

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π!
pg_dump -U postgres -d field_service > backup_before_districts_migration_$(date +%Y%m%d_%H%M%S).sql
```

### –®–∞–≥ 2: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

```bash
psql -U postgres -d field_service -f scripts/migrate_districts_simplification.sql
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≤–µ–¥–µ—Ç –æ—Ç—á—ë—Ç:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–π–æ–Ω–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ (–ú–æ—Å–∫–≤–∞, –°–ü–±, –ò—Ä–∫—É—Ç—Å–∫)
- –¢–û–ü-5 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ä–∞–π–æ–Ω–æ–≤

---

## ‚úÖ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç —Å–∫—Ä–∏–ø—Ç

1. **–ò—Ä–∫—É—Ç—Å–∫:** –î–æ–ª–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è —Ä–æ–≤–Ω–æ 4 –æ–∫—Ä—É–≥–∞
2. **–ú–æ—Å–∫–≤–∞:** –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ 12 –æ–∫—Ä—É–≥–æ–≤
3. **–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥:** –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ 18 —Ä–∞–π–æ–Ω–æ–≤
4. **–í—Å–µ –≥–æ—Ä–æ–¥–∞:** –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≥–æ—Ä–æ–¥–æ–≤ –±–µ–∑ —Ä–∞–π–æ–Ω–æ–≤

**–ü—Ä–∏ –æ—à–∏–±–∫–µ:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–∞—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (BEGIN/COMMIT)

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------------|----------|
| **–í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤** | 39 |
| **–í—Å–µ–≥–æ —Ä–∞–π–æ–Ω–æ–≤** | ~250 |
| **–ì–æ—Ä–æ–¥–æ–≤ –±–µ–∑ —Ä–∞–π–æ–Ω–æ–≤** | 0 |
| **–î—É–±–ª–∏–∫–∞—Ç –°–ü–±** | –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω |

### –¢–û–ü-5 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ —Ä–∞–π–æ–Ω–∞–º:
1. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ - 18
2. –ú–æ—Å–∫–≤–∞ - 12
3. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ - 10
4. –°–∞–º–∞—Ä–∞ - 9
5. –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ - 8

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è:** –í–µ—Å—å —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –ü—Ä–∏ –æ—à–∏–±–∫–µ –æ—Ç–∫–∞—Ç–∏—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é.

2. **–î—É–±–ª–∏–∫–∞—Ç –°–ü–±:** –ì–æ—Ä–æ–¥ "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥" (id=5) –±—É–¥–µ—Ç –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. –û—Å–Ω–æ–≤–Ω—ã–º –æ—Å—Ç–∞—ë—Ç—Å—è "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥" (id=2).

3. **–£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** 
   - –ò–∑ –ò—Ä–∫—É—Ç—Å–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è **650 —Ä–∞–π–æ–Ω–æ–≤**
   - –ò–∑ –ú–æ—Å–∫–≤—ã —É–¥–∞–ª—è–µ—Ç—Å—è **139 —Ä–∞–π–æ–Ω–æ–≤**
   - –ò–∑ –°–ü–± —É–¥–∞–ª—è–µ—Ç—Å—è **111 —Ä–∞–π–æ–Ω–æ–≤**
   
   **–í—Å–µ–≥–æ —É–¥–∞–ª—è–µ—Ç—Å—è ~900 –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `districts`**

4. **Foreign Keys:** –ï—Å–ª–∏ –µ—Å—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∑–∞–∫–∞–∑—ã, –º–∞—Å—Ç–µ—Ä–∞), –º–∏–≥—Ä–∞—Ü–∏—è –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–æ–π—Ç–∏. –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ü–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ –∑–∞–∫–∞–∑–æ–≤/–º–∞—Å—Ç–µ—Ä–æ–≤ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö –∫ —É–¥–∞–ª—è–µ–º—ã–º —Ä–∞–π–æ–Ω–∞–º:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –≤ —É–¥–∞–ª—è–µ–º—ã—Ö —Ä–∞–π–æ–Ω–∞—Ö –ò—Ä–∫—É—Ç—Å–∫–∞
SELECT COUNT(*) 
FROM orders o
JOIN districts d ON o.district_id = d.id
WHERE d.city_id = 4
  AND d.name NOT IN (
    '–õ–µ–Ω–∏–Ω—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥',
    '–û–∫—Ç—è–±—Ä—å—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥',
    '–ü—Ä–∞–≤–æ–±–µ—Ä–µ–∂–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥',
    '–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥'
  );

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Å—Ç–µ—Ä–æ–≤ –≤ —É–¥–∞–ª—è–µ–º—ã—Ö —Ä–∞–π–æ–Ω–∞—Ö
SELECT COUNT(*)
FROM masters m
JOIN master_districts md ON m.id = md.master_id
JOIN districts d ON md.district_id = d.id
WHERE d.city_id = 4
  AND d.name NOT IN (
    '–õ–µ–Ω–∏–Ω—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥',
    '–û–∫—Ç—è–±—Ä—å—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥',
    '–ü—Ä–∞–≤–æ–±–µ—Ä–µ–∂–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥',
    '–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥'
  );
```

**–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**  
–ù—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å –∫–∞–∫ —Å –Ω–∏–º–∏ –ø–æ—Å—Ç—É–ø–∏—Ç—å (–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –¥—Ä—É–≥–∏–µ —Ä–∞–π–æ–Ω—ã –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å).

---

## üîÑ –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
psql -U postgres -d field_service < backup_before_districts_migration_XXXXXX.sql
```

---

## üìù Changelog

**2025-10-04:**
- –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –≤—Å–µ—Ö 40 –≥–æ—Ä–æ–¥–æ–≤
- –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –¥—É–±–ª–∏–∫–∞—Ç–∞ "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥"
- –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º

- [ ] –°–¥–µ–ª–∞–Ω –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∑–∞–∫–∞–∑—ã, –º–∞—Å—Ç–µ—Ä–∞)
- [ ] –°–∫—Ä–∏–ø—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∫–æ–ø–∏–∏ –ë–î
- [ ] –ö–æ–º–∞–Ω–¥–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∞ –æ –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] –ì–æ—Ç–æ–≤ –ø–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ (–±—ç–∫–∞–ø)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é  
**–†–∏—Å–∫:** üü° –°–†–ï–î–ù–ò–ô (—É–¥–∞–ª—è–µ—Ç—Å—è ~900 –∑–∞–ø–∏—Å–µ–π, –Ω–æ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~10 —Å–µ–∫—É–Ω–¥
