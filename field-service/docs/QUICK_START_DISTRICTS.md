# ‚ö° Quick Start: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Ä–∞–π–æ–Ω–æ–≤

**–î–∞—Ç–∞:** 2025-10-04  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~15 –º–∏–Ω—É—Ç

---

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—è

–£–ø—Ä–æ—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–∞–π–æ–Ω–æ–≤:
- **–ò—Ä–∫—É—Ç—Å–∫:** 654 —Ä–∞–π–æ–Ω–∞ ‚Üí 4 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–∞
- **–ú–æ—Å–∫–≤–∞:** 139 —Ä–∞–π–æ–Ω–æ–≤ ‚Üí 12 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–æ–≤  
- **–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥:** 111 —Ä–∞–π–æ–Ω–æ–≤ ‚Üí 18 —Ä–∞–π–æ–Ω–æ–≤
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞:** "–ì–æ—Ä–æ–¥ —Ü–µ–ª–∏–∫–æ–º" ‚Üí 3-10 –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤

---

## ‚úÖ –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- [x] –í –ò—Ä–∫—É—Ç—Å–∫–µ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤ ‚úÖ
- [x] –í –ò—Ä–∫—É—Ç—Å–∫–µ –Ω–µ—Ç –º–∞—Å—Ç–µ—Ä–æ–≤ ‚úÖ
- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –ë–î
- [ ] –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ PostgreSQL
- [ ] –í—ã–±—Ä–∞–Ω–æ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (3 —à–∞–≥–∞)

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)

```bash
cd /path/to/field-service

# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø —Å timestamp
pg_dump -U postgres -d field_service > backup_districts_$(date +%Y%m%d_%H%M%S).sql

# –ò–ª–∏ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∏–º—è
pg_dump -U postgres -d field_service > backup_districts_before_migration.sql
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ –Ω–µ –ø—É—Å—Ç–æ–π:
```bash
ls -lh backup_districts*.sql
```

---

### –®–∞–≥ 2: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
psql -U postgres -d field_service -f scripts/migrate_districts_simplification.sql
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
1. –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥"
2. –£–ø—Ä–æ—Å—Ç–∏—Ç –ò—Ä–∫—É—Ç—Å–∫ –¥–æ 4 –æ–∫—Ä—É–≥–æ–≤
3. –£–ø—Ä–æ—Å—Ç–∏—Ç –ú–æ—Å–∫–≤—É –¥–æ 12 –æ–∫—Ä—É–≥–æ–≤
4. –£–ø—Ä–æ—Å—Ç–∏—Ç –°–ü–± –¥–æ 18 —Ä–∞–π–æ–Ω–æ–≤
5. –ó–∞–≥—Ä—É–∑–∏—Ç —Ä–∞–π–æ–Ω—ã –¥–ª—è 36 –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
6. –í—ã–≤–µ–¥–µ—Ç –æ—Ç—á—ë—Ç –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
NOTICE:  –î—É–±–ª–∏–∫–∞—Ç "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥" (id=5) –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
NOTICE:  –ò—Ä–∫—É—Ç—Å–∫ (id=4): –æ—Å—Ç–∞–ª–æ—Å—å 4 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–∞ ‚úì
NOTICE:  –ú–æ—Å–∫–≤–∞ (id=1): –¥–æ–±–∞–≤–ª–µ–Ω–æ 12 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–∫—Ä—É–≥–æ–≤ ‚úì
NOTICE:  –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ (id=2): –¥–æ–±–∞–≤–ª–µ–Ω–æ 18 —Ä–∞–π–æ–Ω–æ–≤ ‚úì
NOTICE:  
NOTICE:  ========================================
NOTICE:  –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê
NOTICE:  ========================================
NOTICE:  –í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤: 39
NOTICE:  –í—Å–µ–≥–æ —Ä–∞–π–æ–Ω–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ: 250
NOTICE:  –ì–æ—Ä–æ–¥–æ–≤ –±–µ–∑ —Ä–∞–π–æ–Ω–æ–≤: 0
NOTICE:  
NOTICE:  ‚úì –í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏–º–µ—é—Ç —Ä–∞–π–æ–Ω—ã
NOTICE:  
NOTICE:  –î–µ—Ç–∞–ª–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º –≥–æ—Ä–æ–¥–∞–º:
NOTICE:    –ò—Ä–∫—É—Ç—Å–∫ - 4 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:    –ú–æ—Å–∫–≤–∞ - 12 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:    –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ - 18 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:  
NOTICE:  –¢–û–ü-5 –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ä–∞–π–æ–Ω–æ–≤:
NOTICE:    –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ - 18 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:    –ú–æ—Å–∫–≤–∞ - 12 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:    –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ - 10 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:    –°–∞–º–∞—Ä–∞ - 9 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:    –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ - 8 —Ä–∞–π–æ–Ω–æ–≤
NOTICE:  ========================================
COMMIT
```

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
psql -U postgres -d field_service

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –≥–æ—Ä–æ–¥–∞
SELECT c.name, COUNT(d.id) as districts_count
FROM cities c
LEFT JOIN districts d ON d.city_id = c.id
WHERE c.name IN ('–ú–æ—Å–∫–≤–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', '–ò—Ä–∫—É—Ç—Å–∫')
GROUP BY c.id, c.name
ORDER BY c.name;

# –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
-- –ò—Ä–∫—É—Ç—Å–∫           | 4
-- –ú–æ—Å–∫–≤–∞            | 12
-- –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥   | 18

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –≥–æ—Ä–æ–¥–æ–≤ –±–µ–∑ —Ä–∞–π–æ–Ω–æ–≤
SELECT c.name 
FROM cities c
WHERE c.is_active = true
  AND NOT EXISTS (SELECT 1 FROM districts d WHERE d.city_id = c.id);

# –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç—ã–º (no rows)

\q
```

---

## üî• –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –û—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏:
```
ERROR:  <—Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏>
ROLLBACK
```

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ù–µ –ø–∞–Ω–∏–∫–æ–≤–∞—Ç—å! –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. –ë–î –æ—Å—Ç–∞–ª–∞—Å—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
3. –°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É
4. –ò–∑—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –∏ –ª–æ–≥–∏

---

### –ù—É–∂–µ–Ω –æ—Ç–∫–∞—Ç —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–æ)
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
psql -U postgres -d field_service < backup_districts_YYYYMMDD_HHMMSS.sql
```

---

## üìä Smoke Testing (5 –º–∏–Ω—É—Ç)

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

### 1. Master-–±–æ—Ç (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è):
```
/start ‚Üí –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–∞
‚Üí –í—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥: –ò—Ä–∫—É—Ç—Å–∫
‚Üí –í—ã–±—Ä–∞—Ç—å –æ–∫—Ä—É–≥–∞ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞):
   ‚Ä¢ –õ–µ–Ω–∏–Ω—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥
   ‚Ä¢ –û–∫—Ç—è–±—Ä—å—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥
   ‚Ä¢ –ü—Ä–∞–≤–æ–±–µ—Ä–µ–∂–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥
   ‚Ä¢ –°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥
```

### 2. Client-–±–æ—Ç (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞):
```
/start ‚Üí –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
‚Üí –í—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥: –ú–æ—Å–∫–≤–∞
‚Üí –í—ã–±—Ä–∞—Ç—å –æ–∫—Ä—É–≥ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 12 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤):
   ‚Ä¢ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ê–û
   ‚Ä¢ –°–µ–≤–µ—Ä–Ω—ã–π –ê–û
   ‚Ä¢ ... (–∏ —Ç–∞–∫ –¥–∞–ª–µ–µ)
```

### 3. Admin-–±–æ—Ç (–ø—Ä–æ—Å–º–æ—Ç—Ä):
```
/admin ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ì–µ–æ–≥—Ä–∞—Ñ–∏—è
‚Üí –í—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥: –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
‚Üí –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 18 —Ä–∞–π–æ–Ω–æ–≤
```

---

## ‚úÖ Checklist

- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –ë–î
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
- [ ] –í—ã–≤–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω (–Ω–µ—Ç –æ—à–∏–±–æ–∫)
- [ ] Smoke testing –ø—Ä–æ–π–¥–µ–Ω (—Ö–æ—Ç—è –±—ã 1 –≥–æ—Ä–æ–¥)
- [ ] –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º

- **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** –í–µ–¥—É—â–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ / –¢–∏–º–ª–∏–¥
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `docs/DISTRICTS_MIGRATION_2025-10-04.md`
- **Change Request:** `docs/CHANGE_REQUEST_DISTRICTS_2025-10-04.md`

---

**–í—Ä–µ–º—è:** ~15 –º–∏–Ω—É—Ç (5 –±—ç–∫–∞–ø + 1 –º–∏–≥—Ä–∞—Ü–∏—è + 5 smoke testing)  
**–†–∏—Å–∫:** üü° –°–†–ï–î–ù–ò–ô (–µ—Å—Ç—å –±—ç–∫–∞–ø –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è)  
**Downtime:** –ù–µ—Ç
