# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –º–∞—Å—Ç–µ—Ä–∞–º –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö

**–î–∞—Ç–∞:** 2025-10-20  
**–ó–∞–¥–∞—á–∞:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –∏ –ª–∏—à–Ω—é—é —Ç–æ—á–∫—É –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö

## –ü—Ä–æ–±–ª–µ–º—ã

1. **–ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –¥–æ—Å—Ç–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥–∏–ª–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–æ 5 —Å–µ–∫—É–Ω–¥
2. **–õ–∏—à–Ω—è—è —Ç–æ—á–∫–∞ –≤ —Ç–µ–∫—Å—Ç–µ** - –º–µ–∂–¥—É –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞–∫–∞–∑–∞ –∏ —Ç–µ–∫—Å—Ç–æ–º "–û–∂–∏–¥–∞–µ—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ù–æ–≤—ã–µ¬ª" –±—ã–ª–∞ —Ç–æ—á–∫–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–º–µ–Ω—å—à–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–§–∞–π–ª:** `field_service/bots/master_bot/main.py`  
**–°—Ç—Ä–æ–∫–∞:** 83

**–ë—ã–ª–æ:**
```python
run_master_notifications(bot, interval_seconds=5)
```

**–°—Ç–∞–ª–æ:**
```python
run_master_notifications(bot, interval_seconds=1)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –Ω–µ –±–æ–ª–µ–µ 1 —Å–µ–∫—É–Ω–¥—ã –≤–º–µ—Å—Ç–æ 5 —Å–µ–∫—É–Ω–¥.

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —à–∞–±–ª–æ–Ω —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è NEW_OFFER

**–§–∞–π–ª:** `field_service/services/push_notifications.py`  
**–°—Ç—Ä–æ–∫–∏:** 59-66

**–ë—ã–ª–æ:**
```python
NotificationEvent.NEW_OFFER: (
    "üîî <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ #{order_id}</b>\n\n"
    "üìç –ê–¥—Ä–µ—Å: {city}, {district}\n"
    "üïê –í—Ä–µ–º—è: {timeslot}\n"
    "‚öôÔ∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {category}\n\n"
    "{description}\n\n"
    ".–û–∂–∏–¥–∞–µ—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´üì• –ù–æ–≤—ã–µ¬ª."  # <- –ª–∏—à–Ω—è—è —Ç–æ—á–∫–∞ –≤ –Ω–∞—á–∞–ª–µ
),
```

**–°—Ç–∞–ª–æ:**
```python
NotificationEvent.NEW_OFFER: (
    "üîî <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ #{order_id}</b>\n\n"
    "üìç –ê–¥—Ä–µ—Å: {city}, {district}\n"
    "üïê –í—Ä–µ–º—è: {timeslot}\n"
    "‚öôÔ∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {category}\n\n"
    "{description}\n\n"
    "–û–∂–∏–¥–∞–µ—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´üì• –ù–æ–≤—ã–µ¬ª."  # <- —Ç–æ—á–∫–∞ —É–±—Ä–∞–Ω–∞
),
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –±–µ–∑ –ª–∏—à–Ω–µ–π —Ç–æ—á–∫–∏.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞** (`distribution_scheduler.py`)
   - –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ñ—Ñ–µ—Ä–∞ –º–∞—Å—Ç–µ—Ä—É —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `notifications_outbox`
   - –§—É–Ω–∫—Ü–∏—è `notify_master()` –¥–æ–±–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏** (`notifications_watcher.py`)
   - –ó–∞–¥–∞—á–∞ `run_master_notifications()` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –º–∞—Å—Ç–µ—Ä-–±–æ—Ç–µ
   - –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É (—Ç–µ–ø–µ—Ä—å) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É `notifications_outbox`
   - –í—ã–±–∏—Ä–∞–µ—Ç –¥–æ 50 –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ Telegram Bot API
   - –ü–æ–º–µ—á–∞–µ—Ç –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ

3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞** (`push_notifications.py`)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —à–∞–±–ª–æ–Ω `NOTIFICATION_TEMPLATES[NotificationEvent.NEW_OFFER]`
   - –ü–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞: –≥–æ—Ä–æ–¥, —Ä–∞–π–æ–Ω, –≤—Ä–µ–º—è, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –æ–ø–∏—Å–∞–Ω–∏–µ
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Ç–µ—Ä—É

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–∂–Ω–æ:

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∞—Å—Ç–µ—Ä-–±–æ—Ç–∞
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–±–æ—Ç–∞ –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç-–±–æ—Ç–∞
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–∞—Å—Ç–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 —Å–µ–∫—É–Ω–¥)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏ –Ω–µ—Ç –ª–∏—à–Ω–µ–π —Ç–æ—á–∫–∏ –º–µ–∂–¥—É –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ —Ç–µ–∫—Å—Ç–æ–º "–û–∂–∏–¥–∞–µ—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ù–æ–≤—ã–µ¬ª"

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `field_service/bots/master_bot/main.py` - –∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `field_service/services/notifications_watcher.py` - –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–∏
- `field_service/services/push_notifications.py` - —à–∞–±–ª–æ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `field_service/services/distribution_scheduler.py` - —Å–æ–∑–¥–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏
