# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –° –°–ê–ù–ö–¢-–ü–ï–¢–ï–†–ë–£–†–ì–û–ú

## –ü—Ä–æ–±–ª–µ–º–∞
–í –ë–î –≥–æ—Ä–æ–¥ –±—ã–ª –∑–∞–ø–∏—Å–∞–Ω –∫–∞–∫ "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥" (—Å –¥–µ—Ñ–∏—Å–æ–º), –∞ –≤ –∫–æ–¥–µ –∫–∞–∫ "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥" (—Å –ø—Ä–æ–±–µ–ª–æ–º).
–¢–∞–∫–∂–µ –≤ –ë–î –±—ã–ª–æ –≤—Å–µ–≥–æ 39 –≥–æ—Ä–æ–¥–æ–≤ –≤–º–µ—Å—Ç–æ 78.

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ cities.py
- –ò–∑–º–µ–Ω–µ–Ω–æ: `"–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥"` ‚Üí `"–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥"`
- –¢–∞–∫–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∞–ª–∏–∞—Å—ã ("—Å–ø–±", "–ø–∏—Ç–µ—Ä", "—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥")
- –§–∞–π–ª: `field-service/field_service/data/cities.py`

### 2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
- –¢–µ–ø–µ—Ä—å –≥–æ—Ä–æ–¥–∞ –≤—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞, —Ç–∞–∫ –∏ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- –§—É–Ω–∫—Ü–∏—è: `match_cities()` –≤ `cities.py`

### 3. ‚úÖ –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –≥–æ—Ä–æ–¥–æ–≤
- –§–∞–π–ª: `add_missing_cities.py`
- –î–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ 78 –≥–æ—Ä–æ–¥–æ–≤ –∏–∑ `ALLOWED_CITIES` –≤ –ë–î
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ON CONFLICT` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## –®–∞–≥–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–æ—Ç–æ–≤
pkill -f "python.*main.py"
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –≥–æ—Ä–æ–¥–∞
```bash
cd /ProjectF
python add_missing_cities.py
```

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç:
```
=== –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–æ–≤ –≤ –ë–î ===

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω: –¢—É–ª–∞
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω: –ö—É—Ä—Å–∫
...
‚ÑπÔ∏è  –û–±–Ω–æ–≤–ª—ë–Ω: –ú–æ—Å–∫–≤–∞
‚ÑπÔ∏è  –û–±–Ω–æ–≤–ª—ë–Ω: –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥

üìä –ò—Ç–æ–≥–æ:
   –î–æ–±–∞–≤–ª–µ–Ω–æ: 39
   –û–±–Ω–æ–≤–ª–µ–Ω–æ: 39
   –í—Å–µ–≥–æ –≤ —Å–ø–∏—Å–∫–µ: 78
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
python test_spb_search.py
```

–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
```
=== –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ ===

1Ô∏è‚É£ –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π cities.py:
   '–°–ü–±':
      resolve: –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
      match: ['–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥']
   '—Å–∞–Ω–∫—Ç':
      resolve: None
      match: ['–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥']
   ...

2Ô∏è‚É£ –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ —á–µ—Ä–µ–∑ DBOrdersService:
   '–°–ü–±': ['–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥']
   '–°–∞–Ω–∫—Ç': ['–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥']
   ...

3Ô∏è‚É£ –í—Å–µ–≥–æ –≥–æ—Ä–æ–¥–æ–≤ –≤ –ë–î: 78
   –ü–µ—Ä–≤—ã–µ 10 (–ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É):
      - –ê—Å—Ç—Ä–∞—Ö–∞–Ω—å
      - –ë–∞–ª–∞—à–∏—Ö–∞ (–ú–û)
      ...

4Ô∏è‚É£ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ –≤ —Å–ø–∏—Å–∫–µ: ‚úÖ –î–ê
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ
```bash
cd /ProjectF/field-service

# –ê–¥–º–∏–Ω-–±–æ—Ç
python -m field_service.bots.admin_bot.main &

# –ú–∞—Å—Ç–µ—Ä-–±–æ—Ç
python -m field_service.bots.master_bot.main &
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Telegram

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
2. –ù–∞ —ç—Ç–∞–ø–µ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞:
   - –ì–æ—Ä–æ–¥–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å **78 –≥–æ—Ä–æ–¥–æ–≤** (–ø—Ä–æ–ª–∏—Å—Ç–∞–π—Ç–µ –¥–æ –∫–æ–Ω—Ü–∞)
3. –ù–∞–∂–º–∏—Ç–µ "üîç –ü–æ–∏—Å–∫" –∏ –≤–≤–µ–¥–∏—Ç–µ:
   - **"–°–ü–±"** ‚Üí –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥"
   - **"–°–∞–Ω–∫—Ç"** ‚Üí –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥"
   - **"–ø–∏—Ç–µ—Ä"** ‚Üí –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥"

## –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ –≤ –∫–æ–¥–µ

### field-service/field_service/data/cities.py
```python
# –î–û:
ALLOWED_CITIES = (
    "–ú–æ—Å–∫–≤–∞",
    "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥",  # ‚ùå –° –ø—Ä–æ–±–µ–ª–æ–º
    ...
)

_ALIAS_RAW = {
    "—Å–ø–±": "–°–∞–Ω–∫—Ç –ü–µ—Ç–µ—Ä–±—É—Ä–≥",  # ‚ùå
    ...
}

def match_cities(query: str | None) -> List[str]:
    ...
    return matches  # ‚ùå –ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

# –ü–û–°–õ–ï:
ALLOWED_CITIES = (
    "–ú–æ—Å–∫–≤–∞",
    "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",  # ‚úÖ –° –¥–µ—Ñ–∏—Å–æ–º (–∫–∞–∫ –≤ –ë–î)
    ...
)

_ALIAS_RAW = {
    "—Å–ø–±": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",  # ‚úÖ
    ...
}

def match_cities(query: str | None) -> List[str]:
    """Match cities by query and return them in alphabetical order."""
    ...
    return sorted(matches)  # ‚úÖ –° —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
```

## –†–µ–∑—é–º–µ

‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é:
- –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—â–µ—Ç—Å—è –ø–æ –≤—Å–µ–º –∞–ª–∏–∞—Å–∞–º
- –í—Å–µ 78 –≥–æ—Ä–æ–¥–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ë–î
- –ì–æ—Ä–æ–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
